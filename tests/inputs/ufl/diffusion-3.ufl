t=state.scalar_fields["Tracer"]

p=TrialFunction(t.element())
q=TestFunction(t.element())

diffusivity = 0.1

M=p*q*dx
d=-dt*diffusivity*dot(grad(q),grad(p))*dx

A=M-0.5*d
rhs=action(M+0.5*d,t)
tnew=solve(A,rhs)

state.scalar_fields["Tracer"]=tnew
